<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Integração Google</title>
<meta name="google-signin-client_id" content="125016922965-ae7tsoddu2cp3jm58t1bqve8bm8kidtb.apps.googleusercontent.com">
<link href="css/estilos.css" rel="stylesheet" type="text/css" media="all">
<script src="https://apis.google.com/js/client:platform.js?onload=renderButton" async defer></script>
<script src="js/jquery.min.js" type="text/javascript" language="javascript"></script>

<script>

//############ INTEGRANDO GOOGLE ###############

function onSuccess(googleUser) {
	
	var profile = googleUser.getBasicProfile();
	
	$('.idUser').html(profile.getId());
	$('.nomeUser').html(profile.getName());
	$('.emailUser').html(profile.getEmail());
	$('.imgUser').attr("src",profile.getImageUrl());	
	
	console.log('Logado como: ' + googleUser.getBasicProfile().getName());
	$("#login").css("display","none");
	$(".carregando").css("display","block"); 
  
	gapi.client.load('plus','v1', function(){
	 var request = gapi.client.plus.people.list({
	   'userId': 'me',
	   'collection': 'visible'
	 });
	 request.execute(function(resp) {
		console.log('Número de pessoas:' + resp.totalItems);
		
		var htmlLista = "";
		$.each(resp.items, function (index, value) {
			htmlLista+= '<strong>ID: </strong>'+value.id+'<br/><strong>Nome: </strong>'+value.displayName+'<br/><strong>URL: </strong>'+value.url+'<br/><strong>Foto: </strong><img src="'+value.image.url+'"><br/><hr><br/>';
		});
		
		$(".listaAmigos").html(htmlLista);
		
		$(".carregando").css("display","none");
		$("#app").css("display","block");
	 });
	});  
  
}
function onFailure(error) {
  console.log(error);
}
function renderButton() {
  gapi.signin2.render('my-signin2', {
	'scope': 'profile email https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/youtube https://www.googleapis.com/auth/youtube.upload',
	'width': 240,
	'height': 50,
	'longtitle': true,
	'theme': 'dark',
	'onsuccess': onSuccess,
	'onfailure': onFailure
  });
}

$(document).ready(function(e) {

});
</script>

</head>

<body>
    <div id="login">
        <h1>Login Google</h1>
        <div id="my-signin2"></div>
    </div>

    <div id="app" style="display:none;">
        <h1>Dados do Usuários</h1>
        <p>ID: <span class="idUser"></span></p>
        <p>Nome: <span class="nomeUser"></span></p>
        <p>Email: <span class="emailUser"></span></p>
		<p>Foto: <img class="imgUser" src=""/></p>               
        
        <h1>Lista de Amigos Visíveis</h1>
        
        <div class="listaAmigos">
        </div>
                             
    </div>
    
    <div class="carregando" style="display:none;"></div>

</body>
</html>
